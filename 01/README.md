this iteration makes the code nice to work with

use [decaffeinate](https://decaffeinate-project.org/repl/#?useCS2=true&useJSModules=true&loose=false&evaluate=true&stage=full&code=svg%20%3D%20d3.select%20'svg'%0Awidth%20%3D%20svg.node().getBoundingClientRect().width%0Aheight%20%3D%20svg.node().getBoundingClientRect().height%0A%0A%23%20ZOOM%0Azoomable_layer%20%3D%20svg.append%20'g'%0A%0Azoom%20%3D%20d3.zoom()%0A%20%20.scaleExtent(%5B-Infinity%2CInfinity%5D)%0A%20%20.on%20'zoom'%2C%20()%20-%3E%0A%20%20%20%20zoomable_layer%0A%20%20%20%20%20%20.attrs%0A%20%20%20%20%20%20%20%20transform%3A%20d3.event.transform%0A%0Asvg.call%20zoom%0A%0Avis%20%3D%20zoomable_layer.append%20'g'%0A%20%20.attrs%0A%20%20%20%20transform%3A%20%22translate(%23%7Bwidth%2F2%7D%2C%23%7Bheight%2F2%7D)%22%0A%0A%0A%23%20HIERARCHY%0Astratify%20%3D%20d3.stratify()%0A%20%20.parentId%20(d)%20-%3E%20d.id.substring(0%2C%20d.id.lastIndexOf(%22.%22))%0A%0A%20%20%0A%23%20PACK%0Aw%20%3D%20width%20-%208%0Ah%20%3D%20height%20-%208%0Apack%20%3D%20d3.pack()%0A%20%20.size(%5Bw%2C%20h%5D)%0A%20%20.padding%203%0A%20%20%0A%23%20LINE%0Aline%20%3D%20d3.line()%0A%20%20.curve(d3.curveBundle.beta(1))%0A%20%20.x%20(d)%20-%3E%20d.x%0A%20%20.y%20(d)%20-%3E%20d.y%0A%20%20%0Abubble_layer%20%3D%20vis.append%20'g'%0A%20%20.attrs%0A%20%20%20%20transform%3A%20%22translate(%23%7B-w%2F2%7D%2C%23%7B-h%2F2%7D)%22%0A%20%20%0A%0Ad3.csv%20'flare.csv'%2C%20(data)%20-%3E%0A%20%20d3.csv%20'flare_links.csv'%2C%20(links_data)%20-%3E%0A%20%20%20%20%23%20LAYOUT%0A%20%20%20%20%0A%20%20%20%20%23%20circle%20packing%0A%20%20%20%20root%20%3D%20stratify(data)%0A%20%20%20%20%20%20.sum%20(d)%20-%3E%20d.value%0A%20%20%20%20%20%20.sort%20(a%2C%20b)%20-%3E%20d3.descending%20a.value%2C%20b.value%0A%0A%20%20%20%20pack(root)%0A%0A%20%20%20%20%23%20bundling%0A%20%20%20%20%0A%20%20%20%20%23%20index%20nodes%20%26%20objectify%20links%0A%20%20%20%20index%20%3D%20%7B%7D%0A%20%20%20%20root.eachBefore%20(d)%20-%3E%0A%20%20%20%20%20%20index%5Bd.data.id%5D%20%3D%20d%0A%20%20%20%20%0A%20%20%20%20links_data.forEach%20(d)%20-%3E%0A%20%20%20%20%20%20d.source%20%3D%20index%5Bd.source%5D%0A%20%20%20%20%20%20d.target%20%3D%20index%5Bd.target%5D%0A%20%20%20%20%20%20d.path%20%3D%20d.source.path%20d.target%0A%20%20%20%20%0A%0A%20%20%20%20%23%20bubbles%0A%20%20%20%20bubbles%20%3D%20bubble_layer.selectAll%20'.bubble'%0A%20%20%20%20%20%20.data%20root.descendants()%0A%0A%20%20%20%20enb%20%3D%20bubbles.enter().append%20'circle'%0A%20%20%20%20%20%20.attrs%0A%20%20%20%20%20%20%20%20class%3A%20'bubble'%0A%20%20%20%20%20%20%20%20cx%3A%20(d)%20-%3E%20d.x%0A%20%20%20%20%20%20%20%20cy%3A%20(d)%20-%3E%20d.y%0A%20%20%20%20%20%20%20%20r%3A%20(d)%20-%3E%20d.r%0A%0A%20%20%20%20enb.append%20'title'%0A%20%20%20%20%20%20.text%20(d)%20-%3E%20d.id.substring(d.id.lastIndexOf(%22.%22)%20%2B%201).split(%2F(%3F%3D%5BA-Z%5D%5B%5EA-Z%5D)%2Fg).join('%20')%0A%20%20%20%20%20%20%0A%20%20%20%20%23%20links%0A%20%20%20%20links%20%3D%20bubble_layer.selectAll%20'.link'%0A%20%20%20%20%20%20.data%20links_data%0A%20%20%20%20%20%20%0A%20%20%20%20links.enter().append%20'path'%0A%20%20%20%20%20%20.attrs%0A%20%20%20%20%20%20%20%20class%3A%20'link'%0A%20%20%20%20%20%20%20%20d%3A%20(d)%20-%3E%20line%20d.path%0A%20%20%20%20%20%20%20%20) to produce modern Javascript

that modern Javascript is then Prettier formatted https://prettier.io/

---

Same as [the previous example](http://bl.ocks.org/nitaku/72af4fb979e6689cffb3f7a031d9375f), this time leveraging [hierarchical edge bundling](https://www.win.tue.nl/vis1/home/dholten/papers/bundles_infovis.pdf) to show imports between packages (direction is ignored).